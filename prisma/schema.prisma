generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "rhel-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id               String              @id @default(cuid())
  email            String?             @unique
  password         String?
  dailyGoal        Int                 @default(900)
  totalInput       Int                 @default(0)
  level            EnglishLevel        @default(A0)
  createdAt        DateTime            @default(now())
  updatedAt        DateTime            @updatedAt
  image            String?
  emailVerified    DateTime?
  name             String?
  dayStreak        Int                 @default(0)
  dailyWatch       UserDailyWatch[]
  UserVideoHistory UserVideoHistory[]
  videoProgress    UserVideoProgress[]
}

model Video {
  id               String              @id @default(cuid())
  title            String
  duration         Int
  url              String
  thumbnail        String
  level            VideoLevel
  createdAt        DateTime            @default(now())
  UserVideoHistory UserVideoHistory[]
  progress         UserVideoProgress[]
  transcript       VideoTranscript?
}

model UserVideoProgress {
  id             String  @id @default(cuid())
  userId         String
  videoId        String
  watchedSeconds Int     @default(0)
  completed      Boolean @default(false)
  user           User    @relation(fields: [userId], references: [id])
  video          Video   @relation(fields: [videoId], references: [id])

  @@unique([userId, videoId])
}

model UserDailyWatch {
  id             String @id @default(cuid())
  userId         String
  watchedSeconds Int    @default(0)
  date           String
  user           User   @relation(fields: [userId], references: [id])

  @@unique([userId, date])
}

model UserVideoHistory {
  id       String @id @default(cuid())
  userId   String
  videoId  String
  viewedAt String
  user     User   @relation(fields: [userId], references: [id])
  video    Video  @relation(fields: [videoId], references: [id])

  @@unique([userId, videoId])
}

model VideoTranscript {
  id      String @id @default(cuid())
  videoId String @unique
  content String
  video   Video  @relation(fields: [videoId], references: [id])
}

model playing_with_neon {
  id    Int    @id @default(autoincrement())
  name  String
  value Float? @db.Real
}

enum EnglishLevel {
  A0
  A1
  A2
  B1
  B2
  C1
  C2
}

enum VideoLevel {
  Superbeginner @map("SUPER_BEGINNER")
  Beginner      @map("BEGINNER")
  Intermediate  @map("INTERMEDIATE")
  Advanced      @map("ADVANCED")
}
